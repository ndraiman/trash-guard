#!/bin/bash
# trash-guard wrapper - delegates to native trash commands
# https://github.com/ndraiman/trash-guard

set -e

# macOS 15+ has built-in trash command
if [[ "$OSTYPE" == darwin* ]]; then
    if [[ -x /usr/bin/trash ]]; then
        exec /usr/bin/trash "$@"
    else
        echo "Error: macOS trash command not found. Requires macOS 15 (Sequoia) or later." >&2
        echo "" >&2
        echo "Install trash-guard CLI:" >&2
        echo "  curl -fsSL https://raw.githubusercontent.com/ndraiman/trash-guard/main/install-cli.sh | bash" >&2
        exit 1
    fi
fi

# Linux - use gio trash if available, otherwise suggest our CLI
if [[ "$OSTYPE" == linux* ]]; then
    if command -v gio &>/dev/null; then
        exec gio trash "$@"
    else
        echo "Error: No trash command available." >&2
        echo "" >&2
        echo "Install trash-guard CLI:" >&2
        echo "  curl -fsSL https://raw.githubusercontent.com/ndraiman/trash-guard/main/install-cli.sh | bash" >&2
        exit 1
    fi
fi

echo "Error: Unsupported OS ($OSTYPE)" >&2
echo "" >&2
echo "Install trash-guard CLI:" >&2
echo "  curl -fsSL https://raw.githubusercontent.com/ndraiman/trash-guard/main/install-cli.sh | bash" >&2
exit 1
